.pull-right
  .dropdown style="display:inline-block"
    a.btn.btn-primary.dropdown-toggle data-toggle='dropdown' href="#"
      | Actions
      = ' '
      span.caret
    ul.dropdown-menu
      - if !@record.reviewed? && can?(:review, @record)
        li= link_to 'Mark as Reviewed', reviewed_resource_path(@record), method: :put
      - if can?(:update, @record)
        li= link_to 'Edit', edit_resource_path(@record)
      - if can?(:destroy, @record)
        li= link_to 'Delete', resource_path(@record), data: { method: :delete, confirm: 'Are you sure? There is no return.' }
      li= link_to 'View All', collection_path
      - if @record.building_id?
        li= link_to 'View Building', building_path(@record.building_id)

  - if can?(:create, CensusRecord)
    | &nbsp;
    div style="display:inline-block"
      = form_tag(save_as_resource_path(@record), method: :put, class: 'form-inline') do
        = select_tag 'then', options_for_select([['In this family', 'family'], ['In this dwelling', 'dwelling'], ['On this page', 'page'], ['In this enumeration district', 'enumeration']], params[:then]), prompt: 'Select', class: 'form-control'
        = submit_tag 'Add Record', class: 'btn btn-primary'

  - if !@record.reviewed? && can?(:review, @record)
    | &nbsp;
    => link_to 'Good to go!', reviewed_resource_path(@record), class: 'btn btn-danger', data: { method: :put, confirm: 'You are about to make this census record public.' }

h1.page-title= @record.name

.panel.panel-default
  .panel-heading
    h4.panel-title Census Scope
  table.table.table-bordered.table-condensed
    thead
      tr
        th County
        th City
        th Ward
        th Enum Dist
        th Page
        th Line
        th Dwelling
        th Family ID
    tbody
      tr
        td= @record.county
        td= @record.city
        td= @record.ward
        td= @record.enum_dist
        td= "#{@record.page_number}#{@record.page_side}"
        td= @record.line_number
        td= @record.dwelling_number
        td= @record.family_id

.panel.panel-default
  .panel-heading
    h4.panel-title Personal Details
  .panel-body
    .row
      .col-xs-4
        dl
          dt Address
          dd= @record.street_address || 'blank'
        dl
          dt Relation to Head
          dd= @record.relation_to_head.andand.capitalize || 'blank'
        dl
          dt Sex
          dd= @record.sex || 'blank'
        dl
          dt Race
          dd= @record.race || 'blank'
        dl
          dt Age in 1909
          dd= @record.age || 'blank'
        dl
          dt Place of Birth
          dd= @record.pob || 'blank'
        dl
          dt Foreign Born
          dd= @record.foreign_born? ? 'Yes' : 'No'
        dl
          dt Father's POB
          dd= @record.pob_father || 'blank'
        dl
          dt Mother's POB
          dd= @record.pob_mother || 'blank'
        - if @record.year_immigrated?
          dl
            dt Year Immigrated
            dd= @record.year_immigrated
        dl
          dt Naturalized Alien?
          dd= @record.naturalized_alien || 'blank'
        dl
          dt Language Spoken
          dd= @record.language_spoken || 'blank'

      .col-xs-4
        dl
          dt Marital Status
          dd= @record.marital_status || 'blank'
        dl
          dt Years Married
          dd= @record.years_married || 'blank'
        dl
          dt Num Children Born
          dd= @record.num_children_born || 'blank'
        dl
          dt Num Children Alive
          dd= @record.num_children_alive || 'blank'
        dl
          dt Owned or Rented?
          dd= @record.owned_or_rented || 'blank'
        dl
          dt Mortgage?
          dd= @record.mortgage || 'blank'
        dl
          dt Farm or House?
          dd= @record.farm_or_house || 'blank'

      .col-xs-4
        - if @record.profession.present?
          dl
            dt Profession
            dd= @record.profession
        - if @record.industry?
          dl
            dt Industry
            dd= @record.industry
        - if @record.employment?
          dl
            dt Employment
            dd= @record.employment
        dl
          dt Without work?
          dd= yes_no_na @record.unemployed
        - if @record.unemployed_weeks_1909?
          dl
            dt Weeks w/o work 1909
            dd= @record.unemployed_weeks_1909
        dl
          dt Can read?
          dd= yes_no_na @record.can_read
        dl
          dt Can write?
          dd= yes_no_na @record.can_write
        dl
          dt Attended school?
          dd= yes_no_na @record.attended_school
        dl
          dt Civil War Vet?
          dd= @record.civil_war_vet || 'blank'
        dl
          dt Blind?
          dd= @record.blind? ? 'Yes' : 'blank'
        dl
          dt Deaf & Dumb?
          dd= @record.deaf_dumb? ? 'Yes' : 'blank '

- if @record.notes.present?
  .panel.panel-default
    .panel-heading
      h4.panel-title Notes
    .panel-body= simple_format @record.notes

- if @record.fellows.present?
  .panel.panel-default
    .panel-heading
      h4.panel-title Other Family Members
    table.table.table-condensed.table-bordered
      thead
        tr
          th Name
          th Sex
          th Age
          th Relation
          th Profession
      tbody
        - @record.fellows.each do |row|
          tr
            td= link_to row.name, resource_path(row)
            td= row.sex
            td= row.age
            td= row.relation_to_head
            td= row.profession

- if @record.reviewed? && can?(:review, CensusRecord)
  .alert.alert-info
    = "Reviewed by #{@record.reviewed_by.andand.name || 'a kind soul'} on #{@record.reviewed_at.to_s(:long)}"
