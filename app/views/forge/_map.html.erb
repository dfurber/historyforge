<div class="map-wrap" ng-controller="ForgeMapCtrl">
  <ng-map data-map-type-control="true"
          data-street-view-control="true"
          data-tap-disabled="true"
          data-styles="[{ featureType: 'poi', elementType: 'labels', stylers: [{ visibility: 'off' }]}]"
          center="[42.4418353,-76.4987984]">
    <div ng-repeat="building in buildings track by $index">

      <marker position="{{building.latitude}}, {{building.longitude}}"
              z-index="{{ zIndexFor(building) }}"
              icon="{{ markerIcon(building) }}"
              on-mouseover="highlightBuilding(building)"
              on-click="showBuilding(building)"
              id="building-marker-{{building.id}}"
              ng-if="building.latitude"></marker>
    </div>

    <info-window id="building-iw">
      <div ng-non-bindable="">
        <h5>{{ currentBuilding.name }}</h5>
        <div style="width:700px" class="row">
          <div class="col-xs-3">
            <picture ng-if="currentBuilding.photo">
              <!--[if IE 9]><video style="display: none;"><![endif]-->
              <source ng-srcset="/photos/{{currentBuilding.photo}}/15/phone.jpg" media="(max-width:480px)">
              <source ng-srcset="/photos/{{currentBuilding.photo}}/15/tablet.jpg" media="(min-width:481px) and (max-width:1024px)">
              <source ng-srcset="/photos/{{currentBuilding.photo}}/15/desktop.jpg" media="(min-width:1025px)">
              <!--[if IE 9]></video><![endif]-->
              <img src class="img-responsive img-thumbnail">
            </picture>
            <p ng-if="!currentBuilding.photo">
              No photo :(
            </p>
          </div>
          <div class="col-xs-3">
            <p>{{ currentBuilding.street_address }}<br>{{ currentBuilding.city }}, {{ currentBuilding.state }}</p>
            <p><a href="/buildings/{{ currentBuilding.id }}" target="_blank">Open in new tab</a>
          </div>
          <div class="col-xs-6">
            <table class="table table-condensed">
              <thead>
                <tr>
                  <th>Year</th>
                  <th>Name</th>
                  <th>Age</th>
                  <th>Race</th>
                  <th>Sex</th>
                </tr>
              </thead>
              <tbody ng-repeat="year in [1900, 1910, 1920, 1930]">
                <tr ng-repeat="person in currentBuilding.census_records[year]">
                  <td>{{ year }}</td>
                  <td><a href="/census/{{year}}/{{person.id}}" target="_blank">{{ person.name }}</a></td>
                  <td>{{ person.age }}</td>
                  <td>{{ person.race }}</td>
                  <td>{{ person.sex }}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </info-window>

    <div id="layer-slider" ng-show="layer"><div class="ui-slider-handle"> </div> </div>

  </ng-map>
</div>
